# PTFS开发规范
- [版本号](#版本号)
    - [主版本号](#主版本号)
    - [子版本号](#子版本号)
    - [修订版本号](#修订版本号)
    - [分支版本说明](#分支版本说明)
- [端口](#端口)
    - [端口范围](#端口范围)
    - [端口说明文档](#端口说明文档)
    - [新增服务流程](#新增服务流程)
    - [说明](#说明)

## 版本号
格式: `V1.2.9_Free`和`V1.2.9`
### 版本号命名规范
#### 主版本号
主版本号有特殊作用，作为预留，从1开始。
> 注意: 当该版本号变化后，低位的版本号都需要归零。
#### 子版本号
当功能有重大升级，比如增加了一些模块、整个项目设计变化、发生了重构；或者当修订版本累计到一定程度。则该版本号`+1`。
> 注意: 当该版本号变化后，低位的版本号都需要归零。
#### 修订版本号
一般是Bug修复或是一些小的变动，要经常发布修订版，时间间隔不限，修复一个bug即可发布一个修订版。则该版本号`+1`。
#### 分支版本说明
当同一个版本需要分不同情况发布，则该版本说明可以启用，比如软件发布分为试用版(Trial)和完整版(Full)。
* 若没有分支需求，则分支版本说明可以省略，则版本号为`V1.2.9`
* 分支版本说明与前置版本号之间以下划线`_`作为分隔线
* 常用版本说明

    |版本|说明|
    |:---:|:---:|
    |Trial|试用版|
    |Full|完整版|
    |Free|免费版|
    |Demo|演示版|
    |Enhance|增强版|
    |Professional|专业版|

## 端口
随着项目日渐完善以及功能日渐强大，各个节点提供的服务越来越多，使用的端口也越来越多。
本文档做一个初步的端口使用规范，方便开发人员查询已使用的端口。

### 端口范围
|起始|终止|
|:---:|:---:|
|7000|7999|
这个范围内有接近一千个端口，基本能满足使用。若不能满足使用，可以使用别的端口，但是请在文档中记录并说明。
> 8000端口是测试服务时常用的端口，为了避免冲突，终止端口不使用8000
 
 ### 端口说明文档
[端口使用说明](http://gitlab.zzb.com/PTFS/docs/wikis/端口使用说明)中记录每个工程使用的端口以及说明，格式如下:
 SMINER
|地址|端口|说明|
|:---:|:---:|:---:|
|0.0.0.0|7000|ipfs swarm监听|
|127.0.0.1|7001|ipfs gateway|

SMNG
|地址|端口|说明|
|:---:|:---:|:---:|
|0.0.0.0|7000|ipfs swarm监听|
|127.0.0.1|7001|ipfs gateway|
|127.0.0.1|7002|some server|

### 新增服务流程
#### 查询
查询[端口使用说明](http://gitlab.zzb.com/PTFS/docs/wikis/端口使用说明)，找到最后一个使用的端口，若该端口被其它应用占用，则顺延。
以上面的表格为例，若要在SMNG节点中新增一项服务，查询到最后一个使用的端口为`7002`，则新增的服务使用端口`7003`; 
若`7003`被其它应用占用，则顺延使用`7004`，若仍然被占用，则顺延直至未被占用的端口。
#### 新增记录
将上一步中新增服务的使用端口添加到[端口使用说明](http://gitlab.zzb.com/PTFS/docs/wikis/端口使用说明)文档中。
注意: 监听不同的地址代表不同的访问范围
- 0.0.0.0 所有地址都能访问该服务
- 127.0.0.1 只有本机能访问该服务

### 说明
[端口使用说明](http://gitlab.zzb.com/PTFS/docs/wikis/端口使用说明)只适用于开发过程中，我们希望在使用过程中使用这些端口。
但是由于在部署的过程中，被部署的目标主机有各种限制(安全组策略, 被其它软件占用)，不得不修改使用的端口。
因此[端口使用说明](http://gitlab.zzb.com/PTFS/docs/wikis/端口使用说明)中的记录不代表软件运行时真实使用的端口。
